extends ../layout/index.pug
block styles 
    link(rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css")
    link(rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@2.2.13/dist/esri-leaflet-geocoder.css")
block contenido
    div(class="min-h-screen flex")
        include ../usuario/Administrador-Sidebar/administradorSidebar.pug

        // Main Content
        div(class="flex-1")
            // Top Navigation
            header(class="bg-white shadow")
                div(class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 flex justify-between items-center")
                    h1(class="text-3xl font-bold text-gray-900") Publicar Nueva Propiedad
                    div(class="flex items-center space-x-4")
                        div(class="relative")
                            button(class="flex items-center space-x-2 text-gray-700 hover:text-gray-900")
                                img(class="h-8 w-8 rounded-full" src=`https://ui-avatars.com/api/?name=${usuario.nombre}&background=0D8ABC&color=fff` alt=usuario.nombre)
                                span= usuario.nombre

            // Agregar meta tag CSRF en el head
            meta(name="csrf-token" content=csrfToken)

            // Formulario de Propiedad
            main(class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8")
                div(class="px-4 py-6 sm:px-0")
                    div(class="bg-white shadow rounded-lg")
                        form(action="/propiedades/crearPropiedad" method="POST"  class="px-4 py-5 sm:p-6 space-y-8 divide-y divide-gray-200" novalidate)
                            input(type="hidden" name="_csrf" value=csrfToken)
                            
                            // Información Principal
                            div(class="space-y-6")
                                div
                                    h3(class="text-lg leading-6 font-medium text-gray-900") Información de la Propiedad
                                    
                                    if errores
                                        div(class="grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6")                        
                                            each error in errores
                                                div(class="sm:col-span-3")
                                                    p(class="text-red-500 text-sm")= error.msg
                                    p(class="mt-1 text-sm text-gray-500") Ingresa los detalles principales de la propiedad.

                                div(class="grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6")
                                    div(class="sm:col-span-3")
                                        label(for="titulo" class="block text-sm font-medium text-gray-700") Título
                                        div(class="mt-1")
                                            input(type="text" name="titulo" id="titulo" required class="block w-full border-0 border-b-2 border-gray-300 focus:ring-0 focus:border-blue-500 px-0 py-2 text-gray-900 placeholder-gray-400 transition-colors duration-200" value=oldInfo.titulo? oldInfo.titulo : '')

                                    div(class="sm:col-span-3")
                                        label(for="precio" class="block text-sm font-medium text-gray-700") Precio
                                        div(class="mt-1")
                                            input(type="number" name="precio" id="precio" required class="block w-full border-0 border-b-2 border-gray-300 focus:ring-0 focus:border-blue-500 px-0 py-2 text-gray-900 placeholder-gray-400 transition-colors duration-200" value=oldInfo.precio? oldInfo.precio : '')

                                    div(class="sm:col-span-3")
                                        label(for="categoria" class="block text-sm font-medium text-gray-700") Categoría
                                        div(class="mt-1")
                                            select(name="categoria" id="categoria" required class="block w-full border-0 border-b-2 border-gray-300 focus:ring-0 focus:border-blue-500 px-0 py-2 text-gray-900 transition-colors duration-200")
                                                option(value="") -- Seleccione --
                                                each categoria in categorias
                                                    option(value=categoria.id selected=oldInfo.categoria? oldInfo.categoria == categoria.id : false)= categoria.nombre
                                    div(class="sm:col-span-3")
                                        label(for="habitaciones" class="block text-sm font-medium text-gray-700") Habitaciones
                                        div(class="mt-1")
                                            select(name="habitaciones" id="habitaciones" required class="block w-full border-0 border-b-2 border-gray-300 focus:ring-0 focus:border-blue-500 px-0 py-2 text-gray-900 transition-colors duration-200")
                                                option(value="") -- Seleccione --
                                                each habitacion in [0,1, 2, 3, 4, 5]
                                                    option(value=habitacion selected=oldInfo.habitaciones? oldInfo.habitaciones == habitacion : false)= habitacion

                                    div(class="sm:col-span-3")
                                        label(for="wc" class="block text-sm font-medium text-gray-700") Baños
                                        div(class="mt-1")
                                            select(name="wc" id="wc" required class="block w-full border-0 border-b-2 border-gray-300 focus:ring-0 focus:border-blue-500 px-0 py-2 text-gray-900 transition-colors duration-200")
                                                option(value="") -- Seleccione --
                                                each wc in [0,1, 2, 3, 4, 5]
                                                    option(value=wc selected=oldInfo.wc? oldInfo.wc == wc : false)= wc

                                    div(class="sm:col-span-3")
                                        label(for="estacionamiento" class="block text-sm font-medium text-gray-700") Estacionamientos
                                        div(class="mt-1")
                                            select(name="estacionamiento" id="estacionamiento" required class="block w-full border-0 border-b-2 border-gray-300 focus:ring-0 focus:border-blue-500 px-0 py-2 text-gray-900 transition-colors duration-200")
                                                option(value="") -- Seleccione --
                                                each estacionamiento in [0,1, 2, 3, 4, 5]
                                                    option(value=estacionamiento selected=oldInfo.estacionamiento? oldInfo.estacionamiento == estacionamiento : false)= estacionamiento

                            // Ubicación
                            div(class="pt-8")
                                div
                                    h3(class="text-lg leading-6 font-medium text-gray-900") Ubicación
                                    p(class="mt-1 text-sm text-gray-500") Especifica la ubicación de la propiedad.

                                div(class="mt-6 grid grid-cols-1 gap-y-6 gap-x-4 sm:grid-cols-6")
                                    div(class="sm:col-span-3")
                                        label(for="calle" class="block text-sm font-medium text-gray-700") Calle
                                        div(class="mt-1")
                                            input(type="text" name="calle" id="calle" required class="block w-full border-0 border-b-2 border-gray-300 focus:ring-0 focus:border-blue-500 px-0 py-2 text-gray-900 placeholder-gray-400 transition-colors duration-200" value=oldInfo.calle? oldInfo.calle : '')

                                    div(class="sm:col-span-3")
                                        label(for="lat" class="block text-sm font-medium text-gray-700") Latitud
                                        div(class="mt-1")
                                            input(type="text" name="lat" id="lat" required class="block w-full border-0 border-b-2 border-gray-300 focus:ring-0 focus:border-blue-500 px-0 py-2 text-gray-900 placeholder-gray-400 transition-colors duration-200" value=oldInfo.lat? oldInfo.lat : '')

                                    div(class="sm:col-span-3")
                                        label(for="lng" class="block text-sm font-medium text-gray-700") Longitud
                                        div(class="mt-1")
                                            input(type="text" name="lng" id="lng" required class="block w-full border-0 border-b-2 border-gray-300 focus:ring-0 focus:border-blue-500 px-0 py-2 text-gray-900 placeholder-gray-400 transition-colors duration-200" value=oldInfo.lng? oldInfo.lng : '')

                                    div(class="sm:col-span-6")
                                        div(id="mapa" class="h-96 mt-4 rounded-lg shadow-lg")

                            // Descripción
                            div(class="pt-8")
                                div
                                    h3(class="text-lg leading-6 font-medium text-gray-900") Descripción
                                    p(class="mt-1 text-sm text-gray-500") Describe los detalles y características de la propiedad.

                                div(class="mt-6")
                                    label(for="descripcion" class="block text-sm font-medium text-gray-700") Descripción
                                    div(class="mt-1")
                                        textarea(name="descripcion" id="descripcion" rows="4" required class="block w-full border-0 border-b-2 border-gray-300 focus:ring-0 focus:border-blue-500 px-0 py-2 text-gray-900 placeholder-gray-400 transition-colors duration-200" value=oldInfo.descripcion? oldInfo.descripcion : '')
                            // Botones de Acción
                            div(class="pt-8")
                                div(class="flex justify-end space-x-4")
                                    a(href="/auth/vendedor/panel" class="inline-flex items-center px-6 py-3 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200")
                                        i(class="fas fa-times mr-2")
                                        | Cancelar
                                    button(type="submit" class="inline-flex items-center px-6 py-3 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 transform hover:scale-105")
                                        i(class="fas fa-save mr-2")
                                        | Publicar Propiedad
block scripts
    link(rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css")
    link(rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@2.2.13/dist/esri-leaflet-geocoder.css")
    script(src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js")
    script(src="https://unpkg.com/esri-leaflet@3.0.8/dist/esri-leaflet.js") 
    script(src="https://unpkg.com/esri-leaflet-geocoder@2.2.13/dist/esri-leaflet-geocoder.js")
    script(src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-geosearch/2.7.0/bundle.min.js")
    script(src="/js/mapa.js")