extends ../layout/index.pug

block contenido
    if remitente.tipo.toString() === '2'
        div(class="min-h-screen bg-gray-100 flex flex-col")
            include ../usuario/comprador-Sidebar/compradorSidebar.pug
            //- Contenido Principal
            div(class="flex-1 flex flex-col bg-gray-100")
                // Titulo
                div(class="bg-white p-4 shadow-md")
                    div(class="max-w-7xl mx-auto")
                        h1(class="text-3xl font-bold text-[#FF6819]") Mensajes del comprador #{remitente.nombre}
                        p(class="text-gray-600") Gestiona y organiza los mensajes de los compradores
                //- Contenedor de Mensajes
                div(class="flex-1 p-8")
                    //Mensaje de exito
                    if mensajesFlash.length > 0
                        div(class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4" role="alert")   
                            span(class="block sm:inline")= mensajesFlash[0]
                            span(class="absolute top-0 bottom-0 right-0 px-4 py-3")
                                svg(class="fill-current h-6 w-6 text-green-500" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20")
                                    title("Close")
                                    path(d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z")
                    //- Lista de Conversaciones
                    div(class="max-w-7xl mx-auto space-y-6")
                        //- Mensajes Recibidos
                        div(class="bg-white rounded-xl shadow-sm p-6 mb-8")
                            h2(class="text-xl font-semibold text-[#FF6819] mb-4 flex items-center")
                                i(class="fas fa-inbox mr-2")
                                | Mensajes Recibidos
                            each mensaje in mensajesRespondidos
                                //- Mensaje Estático 1
                                div(class="bg-gray-100 rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300 mb-4")
                                    div(class="p-6 bg-white")
                                        div(class="flex items-center justify-between mb-4")
                                            div(class="flex items-center space-x-4")
                                                img(src="/img/avatar.png" class="w-12 h-12 rounded-full object-cover border-2 border-blue-100")
                                                div(class="flex-1 min-w-0")
                                                    h3(class="text-lg font-semibold text-gray-900 truncate") Mensaje para #{mensaje.destinatarioRelacion.nombre} de #{mensaje.remitenteRelacion.nombre}
                                            
                                                    p(class="text-sm text-gray-600 font-bold truncate")= mensaje.propiedadRelacion.titulo
                                                    p(class="text-sm text-gray-500")= mensaje.createdAt.toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit', year: 'numeric' })
                                            div(class="flex items-center space-x-2")
                                                span(class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium") Recibido
                                                a(href=`/mensajes/ver/${mensaje.id}` class="text-sm bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors duration-200 cursor-pointer")
                                                    i(class="fas fa-eye mr-2")
                                                    | Ver Detalles
                                        div(class="mt-4 bg-gray-50 rounded-lg p-4")
                                            p(class="text-gray-700")= mensaje.mensaje

                        //- Mensajes Enviados (Sección Estática)
                        if mensajesEnviados.length > 0
                            div(class="bg-white rounded-xl shadow-sm p-6 mb-8")
                                h2(class="text-xl font-semibold text-[#FF6819] mb-4 flex items-center")
                                    i(class="fas fa-paper-plane mr-2")
                                    | Mensajes Enviados
                                each mensaje in mensajesEnviados
                                    //- Mensaje Estático 1
                                    div(class="bg-gray-100 rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300 mb-4")
                                        div(class="p-6 bg-white")
                                            div(class="flex items-center justify-between mb-4")
                                                div(class="flex items-center space-x-4")
                                                    img(src="/img/avatar.png" class="w-12 h-12 rounded-full object-cover border-2 border-green-100")
                                                    div(class="flex-1 min-w-0")
                                                        h3(class="text-lg font-semibold text-gray-900 truncate") Mensaje para #{mensaje.destinatarioRelacion.nombre}
                                                        p(class="text-sm text-gray-600 font-bold truncate")= mensaje.propiedadRelacion.titulo
                                                        p(class="text-sm text-gray-500")= mensaje.createdAt.toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit', year: 'numeric' })
                                                div(class="flex items-center space-x-2")
                                                    span(class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium") Enviado
                                                    a(href=`/mensajes/ver/${mensaje.id}` class="text-sm bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors duration-200 cursor-pointer")
                                                        i(class="fas fa-eye mr-2")
                                                        | Ver Detalles
                                                    if mensaje.remitenteId === remitente.id
                                                        a(href=`/mensajes/editar/${mensaje.id}` class="text-sm bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-600 hover:scale-105 transition-all duration-300 cursor-pointer")
                                                            i(class="fas fa-edit mr-2")
                                                            | Editar
                                                    form(action=`/mensajes/eliminar/${mensaje.id}` method="POST" class="inline")
                                                        input(type="hidden" name="_csrf" value=csrfToken)
                                                        button(type="submit" class="text-sm bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 hover:scale-105 transition-all duration-300 cursor-pointer")
                                                            i(class="fas fa-trash-alt mr-2")
                                                            | Eliminar
                                            div(class="mt-4 bg-gray-50 rounded-lg p-4")
                                                //- Si el mensaje es muy largo, se corta y se muestra un boton para ver el mensaje completo
                                                if mensaje.mensaje.length > 100
                                                    p(class="text-gray-700 line-clamp-3")= mensaje.mensaje
                                                else
                                                    p(class="text-gray-700")= mensaje.mensaje

                        else
                            div(class="bg-white rounded-xl shadow-sm p-6 mb-8")
                                h2(class="text-xl font-semibold text-[#FF6819] mb-4 flex items-center")
                                    i(class="fas fa-paper-plane mr-2")
                                    | Mensajes Enviados
                                p(class="text-gray-700") No hay mensajes enviados

                        
                            
                        //- Mensajes Respondidos (Sección Estática)
                        div(class="bg-white rounded-xl shadow-sm p-6")
                            h2(class="text-xl font-semibold text-[#FF6819] mb-4 flex items-center")
                                i(class="fas fa-reply-all mr-2")
                                | Mensajes Respondidos
                            each mensaje in mensajesRespondidos
                                //- Mensaje Estático 1
                                div(class="bg-gray-100 rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300 mb-4")
                                    div(class="p-6 bg-white")
                                        div(class="flex items-center justify-between mb-4")
                                            div(class="flex items-center space-x-4")
                                                img(src="/img/avatar.png" class="w-12 h-12 rounded-full object-cover border-2 border-blue-100")
                                                div(class="flex-1 min-w-0")
                                                    h3(class="text-lg font-semibold text-gray-900 truncate") Mensaje para #{mensaje.destinatarioRelacion.nombre} de #{mensaje.remitenteRelacion.nombre}
                                            
                                                    p(class="text-sm text-gray-600 font-bold truncate")= mensaje.propiedadRelacion.titulo
                                                    p(class="text-sm text-gray-500")= mensaje.createdAt.toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit', year: 'numeric' })
                                            div(class="flex items-center space-x-2")
                                                span(class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium") Recibido
                                                a(href=`/mensajes/ver/${mensaje.id}` class="text-sm bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors duration-200 cursor-pointer")
                                                    i(class="fas fa-eye mr-2")
                                                    | Ver Detalles
                                        div(class="mt-4 bg-gray-50 rounded-lg p-4")
                                            p(class="text-gray-700")= mensaje.mensaje

                    //- Mensaje Informativo
                    div(class="max-w-4xl mx-auto mt-8 bg-[#FFF7ED] rounded-lg p-6")
                        div(class="flex items-start space-x-4")
                            div(class="flex-shrink-0")
                                i(class="fas fa-info-circle text-2xl text-[#FF6F39]")
                            div
                                h4(class="text-lg font-semibold text-[#FF6F39] mb-2") Información Importante
                                p(class="text-gray-700")
                                    | Para mantener una comunicación efectiva, te recomendamos:
                                ul(class="list-disc list-inside mt-2 space-y-1 text-gray-700")
                                    li Ser claro y conciso en tus respuestas
                                    li Mantener un tono profesional y cordial
                                    li Responder en un plazo máximo de 24 horas
                                    li Incluir información relevante sobre la propiedad
                                    li Confirmar los detalles importantes por escrito

    else
        div(class="min-h-screen bg-gray-100 flex")
            include ../usuario/vendedor-Sidebar/Vendedor-Sidebar.pug
            //- Contenido Principal
            div(class="flex-1 flex flex-col bg-gray-100")
                //- Encabezado
                header(class="bg-white border-b border-gray-200 px-8 py-6 sticky top-0 z-40")
                    div(class="flex items-center justify-between")
                        div(class="flex items-center space-x-4")
                            img(src="/img/Mensaje.png" alt="Mensaje" class="w-12 h-12")
                            div
                                h1(class="text-2xl font-bold text-[#FF6819]") Mensajes de #{remitente.nombre}

                //- Contenedor de Mensajes
                div(class="flex-1 p-8")
                    //- Lista de Conversaciones
                    div(class="max-w-4xl mx-auto space-y-6")
                        //- Mensajes Recibidos
                        div(class="bg-white rounded-xl shadow-sm p-6 mb-8")
                            h2(class="text-xl font-semibold text-[#FF6819] mb-4 flex items-center")
                                i(class="fas fa-inbox mr-2")
                                | Mensajes Recibidos
                            each mensaje in mensajes
                                //- Mensaje Individual
                                div(class="bg-gray-100 rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300 mb-4")
                                    //- Contenido del Mensaje
                                    div(class="p-6 bg-white")
                                        div(class="flex items-center justify-between mb-4")
                                            //- Información del Usuario
                                            div(class="flex items-center space-x-4")
                                                img(
                                                    src="/img/avatar.png"
                                                    class="w-12 h-12 rounded-full object-cover border-2 border-blue-100"
                                                )
                                                div(class="flex-1 min-w-0")
                                                    h3(class="text-lg font-semibold text-gray-900 truncate")= mensaje.destinatarioRelacion.nombre
                                                    p(class="text-sm text-gray-600 font-bold truncate")= mensaje.propiedadRelacion.titulo
                                                    p(class="text-sm text-gray-600 truncate")= mensaje.destinatarioRelacion.email
                                            
                                            //- Tiempo y Acciones
                                            div(class="flex flex-col items-end space-y-2 ml-4")
                                                span(class="text-sm text-gray-500 whitespace-nowrap") 
                                                div(class="flex space-x-2")
                                                    a(
                                                        href=`/mensajes/ver/${mensaje.id}`
                                                        class="text-sm bg-gradient-to-r from-[#FF641A] to-[#FF9F00] text-white px-4 py-2 rounded-md hover:scale-105 transition-all duration-300 cursor-pointer"
                                                    )
                                                        i(class="fas fa-eye mr-2")
                                                        | Ver Mensaje
                                                    
                                                    a(
                                                        href=`/mensajes/editar/${mensaje.id}`
                                                        class="text-sm bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-600 hover:scale-105 transition-all duration-300 cursor-pointer"
                                                    )
                                                        i(class="fas fa-edit mr-2")
                                                        | Editar
                                                    
                                                    form(action=`/mensajes/eliminar/${mensaje.id}` method="POST" class="inline")
                                                        input(type="hidden" name="_csrf" value=csrfToken)
                                                        button(
                                                            type="submit"
                                                            class="text-sm bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 hover:scale-105 transition-all duration-300 cursor-pointer"
                                                        )
                                                            i(class="fas fa-trash-alt mr-2")
                                                            | Eliminar
                                        
                                        //- Vista Previa del Mensaje
                                        div(class="mt-4 bg-white rounded-lg p-4")
                                            p(class="text-gray-700 line-clamp-1")= mensaje.mensaje

                        //- Mensajes Enviados (Sección Estática)
                        div(class="bg-white rounded-xl shadow-sm p-6 mb-8")
                            h2(class="text-xl font-semibold text-[#FF6819] mb-4 flex items-center")
                                i(class="fas fa-paper-plane mr-2")
                                | Mensajes Enviados
                            //- Mensaje Estático 1
                            div(class="bg-gray-100 rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300 mb-4")
                                div(class="p-6 bg-white")
                                    div(class="flex items-center justify-between mb-4")
                                        div(class="flex items-center space-x-4")
                                            img(src="/img/avatar.png" class="w-12 h-12 rounded-full object-cover border-2 border-green-100")
                                            div(class="flex-1 min-w-0")
                                                h3(class="text-lg font-semibold text-gray-900 truncate") María González
                                                p(class="text-sm text-gray-600 font-bold truncate") Casa en Residencial Las Palmas
                                                p(class="text-sm text-gray-500") Enviado hace 2 días
                                        div(class="flex items-center space-x-2")
                                            span(class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium") Enviado
                                            a(href="#" class="text-sm bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors duration-200")
                                                i(class="fas fa-eye mr-2")
                                                | Ver Detalles
                                    div(class="mt-4 bg-gray-50 rounded-lg p-4")
                                        p(class="text-gray-700") "Me gustaría agendar una visita para ver la propiedad este fin de semana..."

                            //- Mensaje Estático 2
                            div(class="bg-gray-100 rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300")
                                div(class="p-6 bg-white")
                                    div(class="flex items-center justify-between mb-4")
                                        div(class="flex items-center space-x-4")
                                            img(src="/img/avatar.png" class="w-12 h-12 rounded-full object-cover border-2 border-green-100")
                                            div(class="flex-1 min-w-0")
                                                h3(class="text-lg font-semibold text-gray-900 truncate") Juan Pérez
                                                p(class="text-sm text-gray-600 font-bold truncate") Departamento Centro Histórico
                                                p(class="text-sm text-gray-500") Enviado hace 5 días
                                        div(class="flex items-center space-x-2")
                                            span(class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium") Enviado
                                            a(href="#" class="text-sm bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors duration-200")
                                                i(class="fas fa-eye mr-2")
                                                | Ver Detalles
                                    div(class="mt-4 bg-gray-50 rounded-lg p-4")
                                        p(class="text-gray-700") "¿Podrías proporcionarme más información sobre los servicios incluidos en el mantenimiento?"

                        //- Mensajes Respondidos (Sección Estática)
                        div(class="bg-white rounded-xl shadow-sm p-6")
                            h2(class="text-xl font-semibold text-[#FF6819] mb-4 flex items-center")
                                i(class="fas fa-reply-all mr-2")
                                | Mensajes Respondidos
                            //- Mensaje Estático 1
                            div(class="bg-gray-100 rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300 mb-4")
                                div(class="p-6 bg-white")
                                    div(class="flex items-center justify-between mb-4")
                                        div(class="flex items-center space-x-4")
                                            img(src="/img/avatar.png" class="w-12 h-12 rounded-full object-cover border-2 border-blue-100")
                                            div(class="flex-1 min-w-0")
                                                h3(class="text-lg font-semibold text-gray-900 truncate") Carlos Rodríguez
                                                p(class="text-sm text-gray-600 font-bold truncate") Casa en Valle Real
                                                p(class="text-sm text-gray-500") Respondido hace 1 día
                                        div(class="flex items-center space-x-2")
                                            span(class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium") Respondido
                                            a(href="#" class="text-sm bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors duration-200")
                                                i(class="fas fa-eye mr-2")
                                                | Ver Conversación
                                    div(class="mt-4 bg-gray-50 rounded-lg p-4")
                                        p(class="text-gray-700") "Gracias por tu interés. La propiedad está disponible para visitas de lunes a viernes..."

                            //- Mensaje Estático 2
                            div(class="bg-gray-100 rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300")
                                div(class="p-6 bg-white")
                                    div(class="flex items-center justify-between mb-4")
                                        div(class="flex items-center space-x-4")
                                            img(src="/img/avatar.png" class="w-12 h-12 rounded-full object-cover border-2 border-blue-100")
                                            div(class="flex-1 min-w-0")
                                                h3(class="text-lg font-semibold text-gray-900 truncate") Ana Martínez
                                                p(class="text-sm text-gray-600 font-bold truncate") Terreno en Desarrollo
                                                p(class="text-sm text-gray-500") Respondido hace 3 días
                                        div(class="flex items-center space-x-2")
                                            span(class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium") Respondido
                                            a(href="#" class="text-sm bg-gray-100 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-200 transition-colors duration-200")
                                                i(class="fas fa-eye mr-2")
                                                | Ver Conversación
                                    div(class="mt-4 bg-gray-50 rounded-lg p-4")
                                        p(class="text-gray-700") "El terreno cuenta con todos los servicios básicos y está listo para construcción..."

                    //- Mensaje Informativo
                    div(class="max-w-4xl mx-auto mt-8 bg-[#FFF7ED] rounded-lg p-6")
                        div(class="flex items-start space-x-4")
                            div(class="flex-shrink-0")
                                i(class="fas fa-info-circle text-2xl text-[#FF6F39]")
                            div
                                h4(class="text-lg font-semibold text-[#FF6F39] mb-2") Información Importante
                                p(class="text-gray-700")
                                    | Para mantener una comunicación efectiva, te recomendamos:
                                ul(class="list-disc list-inside mt-2 space-y-1 text-gray-700")
                                    li Ser claro y conciso en tus respuestas
                                    li Mantener un tono profesional y cordial
                                    li Responder en un plazo máximo de 24 horas
                                    li Incluir información relevante sobre la propiedad
                                    li Confirmar los detalles importantes por escrito

block scripts
    script.
        document.addEventListener('DOMContentLoaded', function() {
            // Manejo de pestañas
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    // Remover clases activas
                    tabButtons.forEach(btn => {
                        btn.classList.remove('active', 'border-[#FF6819]', 'text-[#FF6819]');
                        btn.classList.add('border-transparent', 'text-gray-500');
                    });
                    tabContents.forEach(content => content.classList.add('hidden'));

                    // Activar pestaña seleccionada
                    button.classList.add('active', 'border-[#FF6819]', 'text-[#FF6819]');
                    button.classList.remove('border-transparent', 'text-gray-500');
                    
                    const tabId = button.dataset.tab;
                    document.getElementById(tabId).classList.remove('hidden');
                });
            });
        });
    