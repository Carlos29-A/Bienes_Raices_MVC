extends ../layout/index.pug

block contenido
    div(class="min-h-screen bg-gray-100 flex")
        include ./Administrador-Sidebar/administradorSidebar.pug

        //- Contenido Principal
        div(class="flex-1 flex flex-col")
            //- Encabezado
            header(class="bg-white border-b border-gray-200 px-8 py-6 shadow-sm")
                div(class="flex items-center justify-between")
                    div(class="flex items-center space-x-4")
                        img(src="/img/Mensaje.png" alt="Mensajes" class="w-12 h-12")
                        div
                            h1(class="text-2xl font-bold text-[#FF6F17]") Gestión de Mensajes
                            p(class="text-gray-600") Administra los mensajes del sistema

            //- Contenedor Principal
            div(class="flex-1 p-8 bg-gray-100")
                //- Barra de Acciones
                div(class="mb-6 flex justify-between items-center")
                    //- Buscador
                    div(class="flex-1 max-w-md")
                        div(class="relative")
                            input(
                                type="text"
                                placeholder="Buscar mensajes..."
                                class="w-full pl-10 pr-4 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-[#FF6F17] focus:border-transparent"
                            )
                            i(class="fas fa-search absolute left-3 top-2.5 text-gray-400")

                    //- Filtros
                    div(class="flex gap-4")
                        select(class="px-4 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-[#FF6F17] focus:border-transparent appearance-none bg-white")
                            option(value="") Todos los estados
                            option(value="leido") Leídos
                            option(value="no-leido") No leídos
                        select(class="px-4 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-[#FF6F17] focus:border-transparent appearance-none bg-white")
                            option(value="") Todos los tipos 
                            option(value="vendedor") Vendedores
                            option(value="comprador") Compradores

                //- Lista de Mensajes
                div(class="grid gap-6")
                    each mensaje in mensajes
                        div(class="bg-white rounded-xl shadow-sm overflow-hidden border border-gray-100 hover:shadow-md transition-shadow duration-200")
                            //- Encabezado del Mensaje
                            div(class="p-6 border-b border-gray-100")
                                div(class="flex items-start justify-between")
                                    //- Información del Remitente
                                    div(class="flex items-start space-x-4")
                                        img(
                                            src="/img/avatar.png"
                                            alt=mensaje.remitenteRelacion.nombre
                                            class="w-12 h-12 rounded-full object-cover border-2 border-orange-100"
                                        )
                                        div
                                            h3(class="text-lg font-semibold text-gray-900")= mensaje.remitenteRelacion.nombre
                                            p(class="text-sm text-gray-600")= mensaje.remitenteRelacion.email
                                            span(class=`inline-block mt-1 px-3 py-1 rounded-full text-sm font-medium ${
                                                mensaje.remitenteRelacion.tipo.toString() === '1' 
                                                    ? 'bg-orange-100 text-[#FF6F17]' 
                                                    : 'bg-blue-100 text-blue-800'
                                            }`)
                                                = mensaje.remitenteRelacion.tipo.toString() === '1' ? 'Vendedor' : 'Comprador'

                                    //- Estado del Mensaje
                                    div(class="flex items-center space-x-2")
                                        if mensaje.leido
                                            span(class="px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800")
                                                | Leído
                                                
                                        else
                                            span(class="px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800")
                                                | No Leído
                                               

                            //- Contenido del Mensaje
                            div(class="p-6")
                                //- Información de la Propiedad
                                div(class="flex items-center gap-4 mb-4 p-3 bg-gray-50 rounded-lg")
                                    img(
                                        src=`/uploads/${mensaje.propiedadRelacion.imagen}`
                                        alt=mensaje.propiedadRelacion.titulo
                                        class="w-16 h-16 object-cover rounded-lg"
                                    )
                                    div
                                        p(class="font-medium text-gray-900")= mensaje.propiedadRelacion.titulo
                                        p(class="text-sm text-[#FF6F17] font-bold")= `$ ${mensaje.propiedadRelacion.precio.toLocaleString()}`
                                        div(class="flex items-center text-sm text-gray-600 mt-1")
                                            img(src="/img/ubicacion.png" alt="Ubicación" class="w-4 h-4 mr-1")
                                            = mensaje.propiedadRelacion.calle

                                //- Mensaje
                                div(class="p-4 bg-gray-50 rounded-lg mb-4")
                                    p(class="text-gray-700")= mensaje.mensaje
                                    p(class="text-xs text-gray-500 mt-2")
                                        i(class="fas fa-clock mr-2")
                                        = mensaje.createdAt.toLocaleString()

                                //- Acciones
                                div(class="flex justify-end space-x-3")
                                    a(
                                        href=`/mensajes/ver/${mensaje.id}`
                                        class="inline-flex items-center px-4 py-2 bg-[#FF6F17] text-white text-sm font-medium rounded-md hover:bg-[#FF8F17] transition-colors duration-200"
                                    )
                                        i(class="fas fa-eye mr-2")
                                        | Ver Mensaje
                                    button(
                                        onclick=`eliminarMensaje(${mensaje.id})`
                                        class="inline-flex items-center px-4 py-2 bg-white border border-red-600 text-red-600 text-sm font-medium rounded-md hover:bg-red-50 transition-colors duration-200"
                                    )
                                        i(class="fas fa-trash-alt mr-2")
                                        | Eliminar

block scripts
    script.
        function eliminarMensaje(id) {
            if(confirm('¿Estás seguro de que deseas eliminar este mensaje?')) {
                // Aquí iría la lógica para eliminar el mensaje
                console.log('Eliminando mensaje:', id);
            }
        }